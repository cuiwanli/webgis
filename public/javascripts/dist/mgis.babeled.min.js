function showImg(e){console.log($(e).data("raw"));var i,a=$(e).data("raw");$('img [src="'+a+'"]')[0]?i=$('img [src="'+a+'"]')[0]:(i=$("<img>").attr({src:a,"class":"full-img"}),$("#gismap").append(i),Intense(i)),i.trigger("click")}$(document).ready(function(){$(".ui.dropdown").dropdown()}),require(["esri/Map","esri/views/MapView","esri/views/SceneView","esri/layers/GraphicsLayer","esri/geometry/Polyline","esri/symbols/SimpleLineSymbol","esri/Graphic","esri/widgets/Popup","esri/PopupTemplate","dojo/domReady!"],function(e,i,a,n,t,r,s,o,h){function l(){function o(n){n&&(this.options=n,this.baseType=n.baseType||this.baseType,this.viewType=n.viewType||this.viewType,this.viewContainer=n.viewContainer||this.viewContainer);var t;this.map=new e({basemap:this.baseType}),t="3D"==this.viewType?new a({container:this.viewContainer,map:this.map,scale:6e6,center:[146,16,0]}):new i({container:this.viewContainer,map:this.map,zoom:7,center:[146,16]}),t.then(function(){t.on("click",function(e){e.graphic&&v.highLightGraphic(e.graphic)})}),_.forEach(this.graphicsLayers,function(e,i){v.map.add(e)}),this.view=t}function l(e,i){var a=this.graphicsLayers[e],n=new t(i.path);"2D"===v.viewType&&(n=new t(_.slice(i.path,0,2)));var o=new r({color:a.color,width:3}),l="<div>start: lat="+i.path[0][0]+" lon="+i.path[0][1]+" alt="+i.path[0][2]+"</div><div>end: lat="+i.path[1][0]+" lon="+i.path[1][1]+" alt="+i.path[1][2]+'</div><img class="prev-img" src='+i.img.substring(0,i.img.lastIndexOf("."))+'-min.jpg alt="image preview" data-raw='+i.img+' onclick="showImg(this)" /><a href='+i.img+" download="+i.img.substring(i.img.lastIndexOf("/"))+'><span class="glyphicon glyphicon-save" />download</a>',c=new s({id:i.id,layerId:e,title:i.name,geometry:n,symbol:o,popupTemplate:new h({title:i.name,content:l})});$(".list-body").append($("<div>").attr("class","list-item").append($("<h4>").attr("class","list-item-name").text(i.name).click(function(){v.view.animateTo(c),v.highLightGraphic(c)})).append(l)),this.graphics[i.id]=c,a.add(c)}function c(){var e=this.highLightedGraphics;_.forEach(e,function(e,i){v.graphicsLayers[e.layerId].remove(e),v.graphicsLayers[e.layerId].add(v.graphics[e.originId])}),this.highLightedGraphics=[]}function d(e){if(!e.originId){this.unHighLightAll();var i=new r({color:[255,0,0],width:5}),a=new s({id:e.id+"-H",originId:e.id,layerId:e.layerId,title:e.title,geometry:e.geometry,symbol:i,popupTemplate:e.popupTemplate});this.graphicsLayers[e.layerId].remove(e),this.graphicsLayers[e.layerId].add(a),this.highLightedGraphics.push(a),console.log("highLighted")}}function p(e,i){return $("#loader-holder").show(),$.get(e).then(function(e){return $("#loader-holder").hide(),_.forEach(e,function(e,a){v.addNewGraphic(i,e)}),console.log("datas.length---"+e.length),e.length>0})}function g(e){return function(){var i="/map/graphics?layerId="+e+"&chunkIndex="+this.chunkIndex[e];return this.chunkIndex[e]++,this.getData(i,e)}}function m(e){_.forEach(e,function(e,i){$(".list-body").append($("<div>").attr("class","list-item").append($("<h4>").attr("class","list-item-name").text(data.name).click(function(){v.view.animateTo(polylineGraphic)})).append(newContent))})}function u(e){function i(){$("#loader-holder").show(),$.get(a,function(n){$("#loader-holder").hide(),_.forEach(n,function(i,a){v.addNewGraphic(e,i)}),console.log("datas.length---"+n.length),n.length>0&&(v.chunkIndex[e]++,a="/map/graphics?layerId="+e+"&chunkIndex="+v.chunkIndex[e],i())})}var a="/map/graphics?layerId="+e+"&chunkIndex="+v.chunkIndex[e];i()}function w(e){var i="/map/graphics?layerId="+e+"&chunkIndex=0";this.getData(i,e),this.chunkIndex[e]=1,this.options.loadAllGraphics!==!1&&(console.log("start loading allllll"),this.loadAllGraphics(e))}function y(e){var i=new n(e),a=this.getNextColor();i.color=a.rgb;var t=$("<button>").attr({"class":"layer-btn ui button basic "+a.name,"data-layerid":e.id,"data-color":a.name}).text(e.id);t.click(function(){var e=$(this);e.hasClass(e.data("color"))?(v.map.remove(v.graphicsLayers[e.data("layerid")]),e.removeClass(e.data("color"))):(v.map.add(v.graphicsLayers[e.data("layerid")]),e.addClass(e.data("color")))}),$("#select-layers").append(t),this.graphicsLayers[e.id]=i,this.map.add(i),console.log("Layer--"+e.id+" initiated!"),this.initGraphics(e.id)}var v={baseType:"oceans",viewType:"3D",viewContainer:"viewDiv",graphicsLayers:{},graphics:{},contents:{},chunkIndex:{},options:{},highLightedGraphics:[],initGis:o,addNewGraphic:l,getData:p,loadMoreGraphics:g,addContentToList:m,loadAllGraphics:u,initGraphics:w,initLayer:y,highLightGraphic:d,unHighLightAll:c};return v.getNextColor=function(){var e=[{name:"red",rgb:"rgb(255, 0, 0)",hex:"#FF0000"},{name:"orange",rgb:"rgb(255, 165, 0)",hex:"#FFA500"},{name:"green",rgb:"rgb(0, 128, 0)",hex:"#008000"},{name:"blue",rgb:"rgb(0, 0, 255)",hex:"#0000FF"},{name:"purple",rgb:"rgb(128, 0, 128)",hex:"#800080"},{name:"yellow",rgb:"rgb(255, 255, 0)",hex:"#FFFF00"},{name:"teal",rgb:"rgb(0, 128, 128)",hex:"#008080"},{name:"olive",rgb:"rgb(128, 128, 0)",hex:"#808000"},{name:"violet",rgb:"rgb(238, 130, 238)",hex:"#EE82EE"},{name:"pink",rgb:"rgb(255, 192, 203)",hex:"#FFC0CB"},{name:"brown",rgb:"rgb(165, 42, 42)",hex:"#A52A2A"},{name:"gray",rgb:"rgb(128, 128, 128)",hex:"#808080"},{name:"black",rgb:"rgb(0, 0, 0)",hex:"#000000"}],i=0;return function(){return i++,e[i]}}(),v}$(document).ready(function(){var e=new l;e.initGis({loadAllGraphics:!1});var i=[{id:"L000",name:"random-layer0"},{id:"L002",name:"random-layer2"},{id:"L001",name:"random-layer1"}];e.view.then(function(){_.forEach(i,function(i,a){e.initLayer(i)})}),$(".changeBT").change(function(){console.log($(this).val()),e.initGis({baseType:$(this).val()})}),$(".changeVT").change(function(){console.log($(this).val()),e.initGis({viewType:$(this).val()})}),$(".view-control-btn").click(function(){$(".view-control").hasClass("control-panel-hidden")?($(".view-control").switchClass("control-panel-hidden","control-panel-shown"),$(this).switchClass("btn-hidden","btn-shown"),$(this).find("i").switchClass("right","left")):($(".view-control").switchClass("control-panel-shown","control-panel-hidden"),$(this).switchClass("btn-shown","btn-hidden"),$(this).find("i").switchClass("left","right"))})})});
//# sourceMappingURL=D:/Documents/GitHub/webgis/public/javascripts/maps/mgis.babeled.min.js.map
